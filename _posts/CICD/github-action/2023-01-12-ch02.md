---
title: '[GitHub-Action] workflow ê¸°ì´ˆ (2)'
excerpt: "Action"

categories:
  - github-action
tags: 
  - [github-action]

date: 2023-01-12
last_modified_at: 2023-01-12
---

# ğŸ¯ëª©í‘œ
`workflow`ëŠ” GitHub ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ë§Œë“  `action`, ë˜ëŠ” ì‚¬ìš©ìê°€ ì§ì ‘ ì •ì˜í•œ `action`ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” workflow fileì„ ì‘ì„±í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë°°ì›Œë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## ğŸ”–Find action and Custom Action
`workflow`ì—ì„œ ì‚¬ìš©ë˜ëŠ” `action`ì€ ë‹¤ìŒì˜ ìœ„ì¹˜ì—ì„œ ì •ì˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- `workflow` íŒŒì¼ì´ ìœ„ì¹˜í•œ ë™ì¼ ë¦¬í¬ì§€í† ë¦¬ 
- í¼ë¸”ë¦­ ë¦¬í¬ì§€í† ë¦¬
- Docker Hubì— publishedëœ ë„ì»¤ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€
  
GitHub MarketplaceëŠ” GitHub ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ë§Œë“  actionì„ ì°¾ì„ ìˆ˜ ìˆëŠ” ì¤‘ì•™ ì €ì¥ì†Œì…ë‹ˆë‹¤. [GitHub Marketplace page](https://github.com/marketplace/actions/)

### ë™ì¼ ë¦¬í¬ì§€í† ë¦¬ì—ì„œ action ì¶”ê°€
---
ì‚¬ìš©í•  actionê³¼ í•´ë‹¹ actionìœ¼ë¡œ êµ¬ì„±ëœ workflow fileì´ ë™ì¼ ë¦¬í¬ì§€í† ë¦¬ì— ìœ„ì¹˜í•œ ê²½ìš° workflow fileì— `{owner}/{repo}@{ref}` ë˜ëŠ” `./path/to/dir` ê²½ë¡œë¥¼ í†µí•´ actionì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
# Example repository file structure:
|-- hello-world (repository)
|   |__ .github
|       â””â”€â”€ workflows
|           â””â”€â”€ my-first-workflow.yml
|       â””â”€â”€ actions
|           |__ hello-world-action
|               â””â”€â”€ action.yml
```

```yaml
# Example workflow file:
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # This step checks out a copy of your repository.
      - uses: actions/checkout@v3
      # This step references the directory that contains the action.
      - uses: ./.github/actions/hello-world-action
```

> Note:
>> `action.yml` íŒŒì¼ì€ actionì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [Metadata syntax for GitHub ACtions](https://docs.github.com/en/actions/creating-actions/metadata-syntax-for-github-actions)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

### í¼ë¸”ë¦­ ë¦¬í¬ì§€í† ë¦¬ì—ì„œ action ì¶”ê°€
---
ì‚¬ìš©í•  actionì´ í•´ë‹¹ actionìœ¼ë¡œ êµ¬ì„±ëœ workflow fileê³¼ ë‹¤ë¥¸ ë¦¬í¬ì§€í† ë¦¬ì— ìœ„ì¹˜í•œ ê²½ìš° workflow fileì— `{owner}/{repo}@{ref}` ê²½ë¡œë¥¼ í†µí•´ actionì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ actionì€ í¼ë¸”ë¦­ ë¦¬í¬ì§€í† ë¦¬ì— ì €ì¥ ë˜ì–´ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

```yaml
jobs:
  my_first_job:
    steps:
      - name: My first step
        uses: actions/setup-node@v3
```

### Docker Hubì— ê²Œì‹œëœ containerë¡œ ë¶€í„° action ì¶”ê°€
---
ë„ì»¤ í—ˆë¸Œì— ê²Œì‹œëœ ë„ì»¤ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì— actionì´ ì •ì˜ëœ ê²½ìš° workflow fileì—ì„œ `docker://{image}:{tag} ê²½ë¡œë¥¼ í†µí•´ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

```yaml
jobs:
  my_first_job:
    steps:
      - name: My first step
        uses: docker://alpine:3.8
```

> Note:
>> workflowì—ì„œ ì°¸ì¡°í•œ Docker Hubë‚´ ì´ë¯¸ì§€ëŠ” ë¨¼ì € ë¬´ê²°ì„± ì²´í¬ë¥¼ í•  ê²ƒì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.

### íŠ¹ì • action ë²„ì „ ì ‘ê·¼
---
workflow fileì—ì„œ íŠ¹ì •í•œ action ë²„ì „ì„ ì§€ì •í•˜ëŠ” 3ê°€ì§€ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤. 

- tag
- SHA(í•´ì‹œ)
- branch

#### Using tags
```yaml
steps:
  - uses: actions/javascript-action@v1.0.1
```

#### Using SHAs
```yaml
steps:
  - uses: actions/javascript-action@172239021f7ba04fe7327647b213799853a9eb89 
```

> Note:
>> SHA ê°’ì€ ì•½ì–´ê°€ ì•„ë‹Œ ì „ì²´ ê°’ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

#### Using branches
```yaml
steps:
  - uses: actions/javascript-action@main
```

> Note:
>> actionì— ëŒ€í•œ ëŒ€ìƒ ë¸Œëœì¹˜ë¥¼ ì§€ì •í•˜ë©´ í•­ìƒ í•´ë‹¹ ë¸Œëœì¹˜ì— ìˆëŠ” ìµœê·¼ ë²„ì „ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.

## workflow ìƒì„±
`workflow`ì—ì„œ ë³€ìˆ˜ ì‚¬ìš©, ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰, action ê°„ì— ë°ì´í„° ë° ì•„í‹°íŒ©íŠ¸ ê³µìœ ì™€ ê°™ì€ ëª‡ ê°€ì§€ ê¸°ìˆ ì„ ì†Œê°œí•©ë‹ˆë‹¤.

### ë³€ìˆ˜ ì‚¬ìš©
---
GitHub actionsì—ëŠ” ê° workflow runì— ëŒ€í•œ ê¸°ë³¸ í™˜ê²½ ë³€ìˆ˜ê°€ í¬í•¨ë©ë‹ˆë‹¤. ë§Œì•½ ì‚¬ìš©ì ì§€ì • í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš° workflow fileì— í•´ë‹¹ ë³€ìˆ˜ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  
ë‹¤ìŒ ì˜ˆì œëŠ” `POSTGRES_HOST`ì™€ `POSTGRES_PORT` ì‚¬ìš©ì ì§€ì • í™˜ê²½ ë³€ìˆ˜ë¥¼ ë§Œë“¤ê³  í•´ë‹¹ ë³€ìˆ˜ë¥¼ `node client.js` ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ”ë° ì°¸ì¡°í•©ë‹ˆë‹¤.
  
```yaml
jobs:
  example-job:
      steps:
        - name: Connect to PostgreSQL
          run: node client.js
          env:
            POSTGRES_HOST: postgres
            POSTGRES_PORT: 5432
```

ìì„¸í•œ ë‚´ìš©ì€ [í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©](https://docs.github.com/ko/actions/configuring-and-managing-workflows/using-environment-variables)ì„ ì°¸ê³ ê³ í•˜ì„¸ìš”.

### ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
---
`action`ì„ ì‚¬ìš©í•˜ì—¬ í• ë‹¹ëœ runnerì—ì„œ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ë° ì…¸ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì˜ˆì œì—ì„œëŠ” `action`ì—ì„œ `run` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ shellì—ì„œ `npm install -g bats`ë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

```bash
jobs:
  example-job:
    steps:
      - run: npm install -g bats
```

ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ `action`ìœ¼ë¡œ ì‹¤í–‰í•˜ë ¤ë©´ ë¦¬í¬ì§€í† ë¦¬ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì €ì¥í•˜ê³  ê²½ë¡œ ë° ì…¸ì„ ì§€ì •í•˜ì—¬ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
jobs:
  example-job:
    steps:
      - name: Run build script
        run: ./.github/scripts/build.sh
        shell: bash
```

### jobs ê°„ì— ë°ì´í„° ê³µìœ 
---
ë™ì¼í•œ workflowì˜ jobê°„ì— ë°ì´í„°ë¥¼ ê³µìœ í•˜ê±°ë‚˜ ë‚˜ì¤‘ì— ì°¸ì¡°í•˜ê¸° ìœ„í•´ íŒŒì¼ì„ ì €ì¥í•˜ë ¤ëŠ” ê²½ìš° GitHub ì•„í‹°íŒ©íŠ¸ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì•„í‹°íŒ©íŠ¸ëŠ” ì½”ë“œë¥¼ ë¹Œë“œí•˜ê³  í…ŒìŠ¤íŠ¸í•  ë•Œ ìƒì„±ë˜ëŠ” íŒŒì¼ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë°”ì´ë„ˆë¦¬ ë˜ëŠ” íŒ¨í‚¤ì§€ íŒŒì¼, í…ŒìŠ¤íŠ¸ ê²°ê³¼, ìŠ¤í¬ë¦°ìƒ· ë˜ëŠ” ë¡œê·¸ íŒŒì¼ì´ ì•„í‹°íŒ©íŠ¸ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ì•„í‹°íŒ©íŠ¸ëŠ” ì•„í‹°íŒ©íŠ¸ê°€ ìƒì„±ëœ workflow runê³¼ ì—°ê²°ë˜ë©° ë‹¤ë¥¸ jobì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ë™ì¼í•œ workflow run ë‚´ì—ì„œ í˜¸ì¶œëœ ëª¨ë“  actionì—ëŠ” í•´ë‹¹ runì˜ ê²°ê³¼ë¡œ ìƒì„±ëœ ì•„í‹°íŒ©íŠ¸ì— ëŒ€í•œ ì“°ê¸° ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆìŠµë‹ˆë‹¤.

> Note:
>> í•˜ë‚˜ì˜ workflowì— ì •ì˜ëœ ì—¬ëŸ¬ jobì€ ì„œë¡œ ë‹¤ë¥¸ runner ì—ì„œ êµ¬ë™ì´ ë˜ê³  í•˜ë‚˜ì˜ workflowëŠ” í•˜ë‚˜ì˜ workflow runê³¼ ì—°ê²°ë©ë‹ˆë‹¤. 

ë‹¤ìŒ ì˜ˆì œëŠ” output.log íŒŒì¼ ì•„í‹°íŒ©íŠ¸ë¥¼ ë§Œë“¤ê³  upload í•©ë‹ˆë‹¤.
```yaml
jobs:
  example-job:
    name: Save output
    steps:
      - shell: bash
        run: |
          expr 1 + 1 > output.log
      - name: Upload output file
        uses: actions/upload-artifact@v3
        with:
          name: output-log-file
          path: output.log
```
![image](https://user-images.githubusercontent.com/87158339/211994418-c7542a4e-14d2-42cb-93aa-d98b44107f7e.png)

ë³„ë„ì˜ workflow runì—ì„œ ì•„í‹°íŒ©íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ë ¤ë©´ `action/download-artifact` actionì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì˜ˆì œëŠ” `output-log-file` ì•„í‹°íŒ©íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.

```yaml
jobs:
  example-job:
    steps:
      - name: Download a single artifact
        uses: actions/download-artifact@v3
        with:
          name: output-log-file
```

ë™ì¼í•œ workflow runì—ì„œ ì—…ë¡œë“œ ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ë‹¤ìš´ë¡œë“œ ì‘ì—…ì´ ì‹œì‘ë˜ì§€ ì•Šë„ë¡ í•˜ë ¤ë©´ `needs: upload-job-name` ì¸ìˆ˜ë¥¼ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.

## ğŸ“Œì¶œì²˜
[ê¹ƒí—ˆë¸Œ ì•¡ì…˜ /GitHub ì‘ì—… ì•Œì•„ë³´ê¸° /GitHub ì‘ì—… ì´í•´](https://docs.github.com/ko/actions/learn-github-actions/understanding-github-actions)




***
    ğŸ‘ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ ì¡°ì–¸ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ë‚¨ê²¨ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}